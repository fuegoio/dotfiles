#! /bin/sh

# Storage of the xrandr
xrandr > $HOME/.core/.cache/xrandr


# Intel drivers
extern="HDMI-1"
intern="eDP-1"

# NVIDIA drivers
if cat $HOME/.core/.cache/xrandr | grep -q "HDMI-1-1"; then
    extern="HDMI-1-1"
    intern="eDP-1-1"
fi

killall picom;

bspc monitor $intern -n $intern

if cat $HOME/.core/.cache/xrandr | grep -q "$extern disconnected"; then
    mons -o
    bspc monitor $intern -o 1 2 3 4 5 6 7 8 9
    bspc monitor $intern -n $intern -d 1 2 3 4 5 6 7 8 9
    bspc monitor $extern -r
    bspc desktop -f 1
else
    if xrandr --props | grep "00ffffffffffff0026cd46662e090000"; then
        $HOME/.core/dual_screen_work.sh
    else
        $HOME/.core/dual_screen.sh
    fi
    bspc monitor $extern -n $extern
    bspc desktop 1 -m $extern
    bspc desktop 2 -m $extern
    bspc desktop 3 -m $extern
    bspc desktop 4 -m $extern
    bspc desktop 5 -m $extern
    bspc desktop 6 -m $extern
    bspc desktop 7 -m $extern
    bspc desktop Desktop -r
    bspc monitor $extern -d 1 2 3 4 5 6 7
    bspc monitor $intern -d 8 9 10
    bspc desktop -f 1
fi

bspc wm -o

feh --bg-scale ~/Pictures/wallpaper.png
$HOME/.config/polybar/start.sh
picom --config "$HOME/.config/picom/picom.conf" -b
